(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{103:function(e,t,a){},107:function(e,t,a){},114:function(e,t,a){e.exports=a.p+"static/media/3_lip_2020_19_43_42_1593804563614.5af8c9e5.gpx"},117:function(e,t,a){e.exports=a.p+"static/media/WOJTEK.04601a8c.kml"},177:function(e,t,a){},180:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),l=a(41),c=a.n(l),i=(a(103),a(2)),u=a.n(i),s=(a(104),a(105),a(78)),m=a(38),d=a(12),f=a(186),p=a(182),g=a(185),y=a(183),E=a(184),b=(a(107),a(16)),v=(a(108),a(80)),h=a.n(v),O=a(81),w=a.n(O),j=a(82),x=a.n(j),k={weight:3,color:"#2c83cb",lineCap:"butt"},C={color:"#06CB13"},L={color:"#cb123d"},S={color:"#999999",dashArray:"3, 3"},z={weight:10},R=a(6),A=a(32),D=a(54),F=a(4),_=a(8),T=a(187),B=a(85),I=function(e,t){return{id:Object(T.a)(),name:e,content:t}},P={entries:{},analysis:{},selected:null},G=function(e){return e.routes.entries},M=function(e){return e.routes.analysis},N=function(e){return e.routes.selected},U=Object(B.a)(M,(function(e){return e.routes.selected}),(function(e,t){if(t)for(var a=0,n=Object.values(e);a<n.length;a++){var r=n[a];if(r){var o=r.find((function(e){return e.id===t.id}));if(o)return o}}})),W=a(86),H=a.n(W),K=a(87),Y=a.n(K),V=a(37),J=function(e){var t=e.getLayers()[0].getLayers(),a=!0,n=!1,r=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var c=o.value;if(c instanceof u.a.Polyline)return c}}catch(i){n=!0,r=i}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}return null},X=function e(t,a){for(var n,r=a.getLayers(),o=0;o<r.length;o++){var l=r[o],c=!1;if(l instanceof u.a.FeatureGroup&&(c=e(t,l)),l instanceof u.a.Path){var i=Object(V.point)([t.lng,t.lat]),s=(n=l)instanceof u.a.Circle?Y()(n.toGeoJSON().geometry.coordinates,n.getRadius(),{steps:10,units:"meters"}):n instanceof u.a.Polygon?n.toGeoJSON():n instanceof u.a.Polyline?new u.a.Polygon(n.getLatLngs()).toGeoJSON():null;if(null===s)continue;c=H()(i,s)}if(c)return c}return!1},Z=function(e,t){for(var a=e.getLatLngs(),n=[],r=0;r<a.length;r++){var o=a[r],l=a[r+1],c=l?(null===l||void 0===l?void 0:l.meta.time.valueOf())-o.meta.time.valueOf():0,i=X(o,t),u=n[n.length-1];if(u||(u={id:Object(T.a)(),type:i?"ontrack":"offtrack",latLngs:[]},n.push(u)),c>1e4){u.latLngs.push(o);var s={id:Object(T.a)(),type:"unknown",latLngs:[]};n.push(s),s.latLngs.push(o)}else if(i){var m=u;"offtrack"!==u.type&&"unknown"!==u.type||(u.latLngs.push(o),m={id:Object(T.a)(),type:"ontrack",latLngs:[]},n.push(m)),m.latLngs.push(o)}else{var d=u;"ontrack"!==u.type&&"unknown"!==u.type||(u.latLngs.push(o),d={id:Object(T.a)(),type:"offtrack",latLngs:[]},n.push(d)),d.latLngs.push(o)}}return n.filter((function(e){return e.latLngs.length>0}))},q=function(e,t){return{type:"ADD_ROUTE",payload:{name:e,content:t}}},Q=function(e,t){return function(a,n){var r=n(),o=function(e,t,a){console.log("Running analysis...");var n={};if(0===a.getLayers().length)return n;for(var r=0,o=Object.entries(e);r<o.length;r++){var l=Object(d.a)(o[r],2)[1],c=t[l.id];if(null===c||void 0===c?void 0:c.gpx){var i=J(c.gpx);if(!i)throw new Error("Polyline layer not found in route.");var u=Z(i,a);n=Object(_.a)({},n,Object(F.a)({},l.id,u))}}return n}(G(r),e,t);a($(o))}},$=function(e){return{type:"ROUTES_ANALYSED",payload:{analyses:e}}},ee=function(e,t,a){return{type:"OVERRIDE_ANALYSIS",payload:{id:e,analysisId:t,type:a}}},te=a(26),ae=a(88),ne=a(89),re={content:""},oe=function(e){return e.track},le=Object(te.combineReducers)({routes:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"ADD_ROUTE":var n=I(a.payload.name,a.payload.content);return Object(_.a)({},t,{entries:Object(_.a)({},t.entries,Object(F.a)({},n.id,n))});case"REMOVE_ROUTE":var r=t.entries,o=a.payload.id,l=(r[o],Object(A.a)(r,[o].map(D.a))),c=t.analysis,i=a.payload.id,u=(c[i],Object(A.a)(c,[i].map(D.a)));return Object(_.a)({},t,{entries:l,analysis:u});case"ROUTE_PARSED":return Object(_.a)({},t,{entries:Object(_.a)({},t.entries,Object(F.a)({},a.payload.id,Object(_.a)({},t.entries[a.payload.id])))});case"ROUTE_ANALYSED":return Object(_.a)({},t,{analysis:Object(_.a)({},t.analysis,Object(F.a)({},a.payload.id,a.payload.analysis))});case"ROUTES_ANALYSED":return Object(_.a)({},t,{analysis:a.payload.analyses,selected:null});case"CHANGE_ROUTE_NAME":return Object(_.a)({},t,{entries:Object(_.a)({},t.entries,Object(F.a)({},a.payload.id,Object(_.a)({},t.entries[a.payload.id],{name:a.payload.name})))});case"SELECT_POLYLINE":return a.payload.id?Object(_.a)({},t,{selected:{id:a.payload.id,analysis_id:a.payload.analysisId}}):Object(_.a)({},t,{selected:null});case"OVERRIDE_ANALYSIS":return Object(_.a)({},t,{analysis:Object(_.a)({},t.analysis,Object(F.a)({},a.payload.analysisId,null===(e=t.analysis[a.payload.analysisId])||void 0===e?void 0:e.map((function(e){return e.id===a.payload.id?Object(_.a)({},e,{type:a.payload.type}):e}))))});default:return t}},track:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_TRACK":return Object(_.a)({},e,{content:t.payload.content});default:return e}}}),ce=o.a.createContext({layers:{},trackLayer:new u.a.FeatureGroup,setGpx:function(){}}),ie=a(114),ue={gpx_options:{joinTrackSegments:!0},marker_options:{startIconUrl:h.a,endIconUrl:w.a,shadowUrl:x.a},polyline_options:k},se=function(){var e=Object(b.b)().map,t=Object(R.c)(G),a=Object(r.useContext)(ce),n=a.layers,o=a.setGpx,l=Object(R.b)();return Object(r.useEffect)((function(){l(q("3_lip_2020_19_43_42_1593804563614.gpx",ie))}),[l]),Object(r.useEffect)((function(){e&&t&&(Object.entries(t).forEach((function(t){var a=Object(d.a)(t,2),r=(a[0],a[1]),c=n[r.id];if(c&&!c.gpx){var i=new u.a.GPX(r.content,ue);o(r.id,i),l({type:"ROUTE_PARSED",payload:{id:r.id}}),i.addTo(c.layers),c.layers.addTo(e)}})),Object.entries(n).forEach((function(e){var a=Object(d.a)(e,2),n=a[0],r=a[1];t[n]||r.layers.remove()})))}),[e,t,n,o,l]),Object(r.useEffect)((function(){if(e){var a=function(e,t){return Object.values(e).reduce((function(e,a){var n=t[a.id];return n&&n.gpx?e?e.extend(n.gpx.getBounds()):n.gpx.getBounds():e}),null)}(t,n);a&&e.fitBounds(a)}}),[n,e,t]),null},me=(a(115),function(e){var t=e.drawingMode,a=void 0!==t&&t,o=Object(b.b)().map,l=Object(r.useContext)(ce).trackLayer;return Object(r.useEffect)((function(){var e={position:"topleft",draw:{polyline:!1,marker:!1,circlemarker:!1},edit:{featureGroup:l}};n=new u.a.Control.Draw(e)}),[o,l]),Object(r.useEffect)((function(){o&&o.addLayer(l)}),[o,l]),Object(r.useEffect)((function(){o&&n&&(a?o.addControl(n):o.removeControl(n))}),[o,a]),Object(r.useEffect)((function(){o&&o.on(u.a.Draw.Event.CREATED,(function(e){var t=e.layer;l.addLayer(t)}))}),[o,l]),null}),de=function(){var e=Object(R.b)(),t=Object(b.b)().map,a=Object(r.useContext)(ce),n=a.layers,o=a.trackLayer,l=Object(r.useCallback)((function(){e(Q(n,o))}),[n,o]);return Object(r.useEffect)((function(){return function(e,t){if(e){console.log("Registering leaflet event listeners...");var a=function(e){return t()};return e.on(u.a.Draw.Event.CREATED,a),e.on(u.a.Draw.Event.EDITED,a),e.on(u.a.Draw.Event.DELETED,a),e.on("TRACK_LOADED",a),function(){e.off(u.a.Draw.Event.CREATED,a),e.off(u.a.Draw.Event.EDITED,a),e.off(u.a.Draw.Event.DELETED,a),e.off("TRACK_LOADED",a)}}}(t,l)}),[l]),Object(r.useEffect)((function(){e(Q(n,o))}),[l]),null},fe=function(e,t,a,n,r){t.offtrackMarkersLayer.clearLayers(),t.offtrackFragmentsLayer.clearLayers(),t.ontrackMarkersLayer.clearLayers(),t.ontrackFragmentsLayer.clearLayers(),a.forEach((function(a){var o=Object(_.a)({},k,{},function(e){switch(e){case"ontrack":return C;case"offtrack":return L;default:return S}}(a.type),{},(null===n||void 0===n?void 0:n.id)===a.id?z:{}),l=u.a.polyline(a.latLngs,o);l.on("click",(function(t){r(a.id,e)})).on("mouseover",(function(e){l.setStyle(Object(_.a)({},o,{},z))})).on("mouseout",(function(e){l.setStyle(o)})).addTo(t.offtrackFragmentsLayer)}))},pe=function(){var e=Object(b.b)().map,t=Object(R.c)(M),a=Object(r.useContext)(ce).layers,n=Object(R.c)(G),o=!Object.keys(t).length,l=Object(R.b)(),c=Object(r.useCallback)((function(e,t){return l(function(e,t){return{type:"SELECT_POLYLINE",payload:{id:e,analysisId:t}}}(e,t))}),[l]),i=Object(R.c)(N);return Object(r.useEffect)((function(){if(e)for(var r=0,l=Object.entries(n);r<l.length;r++){var u=Object(d.a)(l[r],2),s=u[0],m=u[1],f=a[m.id];if(null===f||void 0===f?void 0:f.gpx){var p=J(f.gpx);if(!p)throw new Error("Polyline layer not found in route.");o||e.removeLayer(p),o&&!e.hasLayer(p)&&e.addLayer(p);var g=t[s]||[];fe(s,f,g,i,c)}}}),[e,t,i,n,a,o,c]),null},ge=(a(116),function(e){return{type:"LOAD_TRACK",payload:{content:e}}}),ye=a(117),Ee=function(){var e=Object(b.b)().map,t=Object(R.b)(),a=Object(r.useContext)(ce).trackLayer,n=Object(R.c)(oe);return Object(r.useEffect)((function(){(function(e,t){var a=new window.XMLHttpRequest;a.open("GET",e);try{a.overrideMimeType("text/xml")}catch(n){}a.onreadystatechange=function(){4===a.readyState&&200===a.status&&t(a.responseText)},a.send(null)})(ye,(function(e){return t(ge(e))}))}),[t]),Object(r.useEffect)((function(){if(e&&(null===n||void 0===n?void 0:n.content)){var t=(new DOMParser).parseFromString(n.content,"text/xml");new u.a.KML(t).getLayers()[0].getLayers().forEach((function(e){return a.addLayer(e)})),e.fireEvent("TRACK_LOADED")}}),[e,n,a]),null},be=function(){var e=Object(r.useState)({lat:51.505,lng:-.09}),t=Object(d.a)(e,1)[0],a=Object(r.useState)(13),n=Object(d.a)(a,1)[0];return o.a.createElement("div",{className:"map-container"},o.a.createElement(f.a,{center:t,zoom:n,zoomControl:!1,preferCanvas:!1},o.a.createElement(p.a,{position:"topright"},o.a.createElement(p.a.BaseLayer,{checked:!0,name:"Mapa"},o.a.createElement(g.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})),o.a.createElement(p.a.BaseLayer,{name:"Satelita"},o.a.createElement(g.a,{attribution:"Tiles \xa9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}))),o.a.createElement(y.a,{position:"topleft"}),o.a.createElement(E.a,{position:"bottomleft",imperial:!1}),o.a.createElement(de,null),o.a.createElement(se,null),o.a.createElement(Ee,null),o.a.createElement(me,null),o.a.createElement(pe,null)))},ve=a(24),he=a(1),Oe=a(27),we=a.n(Oe),je=a(46),xe=a(20),ke=a.n(xe),Ce=a(90),Le=(a(174),a(175),ke()({autoProceed:!0,restrictions:{allowedFileTypes:[".gpx",".kml"]}})),Se=function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(){return t(n.result)},n.onerror=a,n.readAsText(e)}))},ze=function(){var e=Object(R.b)();return Object(r.useEffect)((function(){Le.on("file-added",function(){var t=Object(je.a)(we.a.mark((function t(a){var n;return we.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.info(a),t.next=3,Se(a.data);case 3:n=t.sent,"gpx"===a.extension?e(q(a.name,n)):"kml"===a.extension&&e(ge(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]),o.a.createElement(Ce.a,{uppy:Le,locale:{strings:{dropHereOr:"Przeci\u0105gnij i upu\u015b\u0107 pliki lub %{browse} (dozwolone formaty: .gpx, .kml)",browse:"przegl\u0105daj"}}})},Re={"light-blue-050":"#EBF8FF","light-blue-100":"#D1EEFC","light-blue-200":"#A7D8F0","light-blue-300":"#7CC1E4","light-blue-400":"#55AAD4","light-blue-500":"#3994C1","light-blue-600":"#2D83AE","light-blue-700":"#1D6F98","light-blue-800":"#166086","light-blue-900":"#0B4F71","green-050":"#E3F9E5","green-100":"#C1EAC5","green-200":"#A3D9A5","green-300":"#7BC47F","green-400":"#57AE5B","green-500":"#3F9142","green-600":"#2F8132","green-700":"#207227","green-800":"#0E5814","green-900":"#05400A","cool-grey-050":"#F5F7FA","cool-grey-100":"#E4E7EB","cool-grey-200":"#CBD2D9","cool-grey-300":"#9AA5B1","cool-grey-400":"#7B8794","cool-grey-500":"#616E7C","cool-grey-600":"#52606D","cool-grey-700":"#3E4C59","cool-grey-800":"#323F4B","cool-grey-900":"#1F2933","purple-050":"#EAE2F8","purple-100":"#CFBCF2","purple-200":"#A081D9","purple-300":"#8662C7","purple-400":"#724BB7","purple-500":"#653CAD","purple-600":"#51279B","purple-700":"#421987","purple-800":"#34126F","purple-900":"#240754","red-050":"#FFEEEE","red-100":"#FACDCD","red-200":"#F29B9B","red-300":"#E66A6A","red-400":"#D64545","red-500":"#BA2525","red-600":"#A61B1B","red-700":"#911111","red-800":"#780A0A","red-900":"#610404","yellow-050":"#FFFAEB","yellow-100":"#FCEFC7","yellow-200":"#F8E3A3","yellow-300":"#F9DA8B","yellow-400":"#F7D070","yellow-500":"#E9B949","yellow-600":"#C99A2E","yellow-700":"#A27C1A","yellow-800":"#7C5E10","yellow-900":"#513C06"},Ae={body:"14px",12:"".concat(.75,"rem"),14:"".concat(.875,"rem"),16:"".concat(1,"rem"),18:"".concat(1.125,"rem"),20:"".concat(1.25,"rem"),24:"".concat(1.5,"rem"),30:"".concat(1.875,"rem"),36:"".concat(2.25,"rem"),48:"".concat(3,"rem")},De={4:"".concat(.25,"rem"),8:"".concat(.5,"rem"),12:"".concat(.75,"rem"),16:"".concat(1,"rem"),24:"".concat(1.5,"rem"),32:"".concat(2,"rem"),48:"".concat(3,"rem"),64:"".concat(4,"rem"),96:"".concat(6,"rem"),128:"".concat(8,"rem")},Fe={colors:{text:Re["cool-grey-800"],textLight:Re["cool-grey-050"],background:"#fff",primary:Re["purple-500"],secondary:Re["cool-grey-400"],muted:Re["cool-grey-500"],gray:Re["cool-grey-300"],highlight:"hsla(205, 100%, 40%, 0.125)",header:Re["cool-grey-200"]},fonts:{body:"Lato, system-ui, sans-serif",heading:"inherit",monospace:"Menlo, monospace"},fontSizes:Ae,fontWeights:{body:400,heading:700,bold:700},lineHeights:{body:1.5,heading:1.25},space:De,radii:{default:".375rem"},shadows:{card:"0 0 4px rgba(0, 0, 0, .125)"},input:{marginRight:De[8],padding:De[8],border:"0",boxShadow:"inset 0 0 2px"},text:{heading:{fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",letterSpacing:"-1px",fontSize:Ae[48],h1:{letterSpacing:"-1px",marginBottom:De[12],fontSize:Ae[48]},h2:{letterSpacing:"-1px",marginBottom:De[12],fontSize:Ae[30]},h3:{letterSpacing:"-1px",marginBottom:De[12],fontSize:Ae[24]},h4:{letterSpacing:"-1px",marginBottom:De[12],fontSize:Ae[20]}},display:{fontFamily:"heading",fontWeight:"heading",lineHeight:"heading",fontSize:[Ae[24],Ae[30],Ae[36]]},caps:{textTransform:"uppercase",letterSpacing:"0.1em"},iconButtonText:{marginLeft:De[8]},routeName:{marginRight:De[8],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginBottom:0,fontSize:Ae[20],editable:{marginRight:De[8],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginBottom:0,fontSize:Ae[16]}},instruction:{fontSize:Ae[12],color:"muted"}},variants:{header:{backgroundColor:"header",letterSpacing:"-2px",padding:De[16],justifyContent:"space-between",alignItems:"center"},sidebar:{boxShadow:"0 1px 5px rgba(0,0,0,0.65)",borderRadius:"default",overflow:"hidden"},popup:{variant:"variants.sidebar",marginTop:De[12],backgroundColor:"rgb(255 255 255 / 90%)"},content:{px:De[24],py:De[16],overflow:"auto",overflowX:"hidden"},container:{marginBottom:De[16]},label:{marginBottom:De[4]},description:{marginBottom:De[16]},alert:{marginBottom:De[16],iconContainer:{borderRadius:"50%",backgroundColor:Re["yellow-300"],width:Ae[24],height:Ae[24],alignItems:"center",justifyContent:"center",marginRight:De[8]},icon:{color:Re["yellow-800"],boxShadow:0,padding:0}},link:{color:"primary"},nav:{px:De[24],py:De[16],justifyContent:"center",marginTop:"auto","*:not(:only-child):not(:first-of-type)":{marginLeft:De[8]}},routeSummary:{pb:De[16]},table:{width:"100%",textAlign:"center",borderSpacing:0},th:{px:De[4],py:De[8]},td:{px:De[4],py:De[8],borderBottom:"solid 1px",borderColor:Re["cool-grey-100"]}},buttons:{primary:{cursor:"pointer",fontSize:Ae[16],color:"background",bg:"primary",borderRadius:"default",px:De[16],py:De[8]},outline:{variant:"buttons.primary",color:"primary",bg:"transparent",boxShadow:"inset 0 0 2px"},primaryOutline:{variant:"buttons.outline"},secondary:{variant:"buttons.primary",color:"background",bg:"secondary"},secondaryOutline:{variant:"buttons.outline",color:"secondary"},greenOutline:{variant:"buttons.outline",color:Re["green-600"],":hover:not(.active), :focus:not(.active)":{color:"background",bg:Re["green-600"]}},destructive:{variant:"buttons.primary",bg:Re["red-600"],color:"background"},destructiveOutline:{variant:"buttons.outline",color:Re["red-500"],":hover:not(.active), :focus:not(.active)":{color:"background",bg:Re["red-600"]}},icon:{variant:"buttons.outline",color:"muted",boxShadow:0,padding:0},github:{variant:"buttons.outline",boxShadow:0,fontSize:Ae[24],color:"muted",":hover:not(.active), :focus:not(.active)":{color:"primary"}}}},_e=Object(_.a)({},Fe,{palette:Re}),Te=function(e){var t=e.children,a=e.icon,n=Object(A.a)(e,["children","icon"]);return o.a.createElement(he.b,n,a&&o.a.createElement("i",{className:"".concat(a),style:{marginRight:t?De[4]:0}}),t)},Be=function(e){return o.a.createElement(Te,Object.assign({as:m.b},e))},Ie=function(e){var t=e.href,a=Object(A.a)(e,["href"]);return o.a.createElement(Te,Object.assign({as:he.e,href:t},a))},Pe=a(92),Ge=function(e){var t=e.defaultValue,a=e.onAccept,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=n.current;e&&e.focus()}),[]),o.a.createElement(Pe.a,{ref:n,id:"name",name:"name",type:"text",defaultValue:t,onBlur:function(){return a(n.current&&n.current.value)}})},Me=function(e){var t=e.name,a=e.onChange,n=Object(r.useState)(!1),l=Object(d.a)(n,2),c=l[0],i=l[1];return c?o.a.createElement(Ge,{defaultValue:t,onAccept:function(e){i(!1),e&&a(e)}}):o.a.createElement(he.a,{sx:{cursor:"pointer"},onClick:function(){return i(!0)}},o.a.createElement(he.d,{variant:"routeName.editable"},t),o.a.createElement(he.f,{variant:"instruction"},"Kliknij, aby zmieni\u0107 nazw\u0119..."))},Ne=function(e){var t=e.route,a=Object(R.b)();return o.a.createElement(he.a,{variant:"container"},o.a.createElement(he.c,{mb:De[12],sx:{justifyContent:"space-between",alignItems:"center",minHeight:De[48]}},o.a.createElement(Me,{name:t.name,onChange:function(e){return a(function(e,t){return{type:"CHANGE_ROUTE_NAME",payload:{id:e,name:t}}}(t.id,e))}}),o.a.createElement(he.c,{sx:{flexWrap:"nowrap",flexShrink:0}},o.a.createElement(Te,{variant:"destructiveOutline",icon:"fa-fw fas fa-times",sx:{height:"100%"},onClick:function(){return a({type:"REMOVE_ROUTE",payload:{id:t.id}})}}))))},Ue=function(){var e=Object(R.c)(G),t=Object.keys(e).length;return o.a.createElement(o.a.Fragment,null,o.a.createElement(he.a,{variant:"container"},o.a.createElement(ze,null)),t>0&&o.a.createElement(he.a,{variant:"container"},o.a.createElement(he.d,{variant:"heading.h3"},"Za\u0142adowane przebiegi")),0===t&&o.a.createElement(he.f,null,"Nie za\u0142adowano \u017cadnych tras, przeci\u0105gnij pliki ",o.a.createElement("code",null,".gpx")," do okna powy\u017cej, lub u\u017cyj przegl\u0105darki plik\xf3w."),Object.entries(e).map((function(e){var t=Object(d.a)(e,2),a=(t[0],t[1]);return o.a.createElement(Ne,{key:"route-".concat(a.id),route:a})})))},We=(a(177),function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(he.f,{fontSize:Ae[18],color:"text",sx:{textAlign:"justify",whiteSpace:"pre-line"}},o.a.createElement("p",null,"Witaj w aplikacji przeznaczonej do analizy tras ",o.a.createElement("code",null,".gpx"),". Dzi\u0119ki interaktywnej mapie, por\xf3wnasz za\u0142adowane trasy z wyznaczonym torem, otrzymuj\u0105c szczeg\xf3\u0142owe informacje, podsumowanie i punktacje dla ka\u017cdej z nich."),o.a.createElement("p",null,"Projekt powsta\u0142 na potrzeby organizacji amatorskich zawod\xf3w lotniczych przez cz\u0142onk\xf3w Aeroklubu Szczeci\u0144skiego.")))}),He=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"table",variant:"table"},e))})),Ke=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"thead",variant:"thead"},e))})),Ye=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"tbody",variant:"tbody"},e))})),Ve=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"tr",variant:"tr"},e))})),Je=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"th",variant:"th"},e))})),Xe=o.a.forwardRef((function(e,t){return o.a.createElement(he.a,Object.assign({ref:t,as:"td",variant:"td"},e))})),Ze=a(15),qe=a.n(Ze),Qe=function(e,t){var a=t.diff(e);return qe.a.utc(a).format("HH:mm:ss")},$e=function(e,t){var a=e.get_distance(),n=e.get_start_time().toString(),r=e.get_end_time().toString(),o=e.get_moving_speed(),l=e.get_total_speed(),c=e.get_elevation_min(),i=e.get_elevation_max(),u=Qe(qe()(n),qe()(r)),s=function(e){return e.map((function(e){return"ontrack"===e.type?[]:[e.latLngs[0],e.latLngs[e.latLngs.length-1]]})).filter((function(e){return e.length}))}(t||[]),m=function(e){var t=e.reduce((function(e,t){var a=qe()(t[0].meta.time);return e+=qe()(t[1].meta.time).diff(a)}),0);return qe.a.utc(t).format("HH:mm:ss")}(s);return{startTime:qe()(n).format(),endTime:qe()(r).format(),routeLength:u,distance:"".concat(a.toFixed(2)," m"),movingSpeed:"".concat(o.toFixed(2)," km/h"),totalSpeed:"".concat(l.toFixed(2)," km/h"),elevationMin:"".concat(c," m"),elevationMax:"".concat(i," m"),offtrackIntervals:s.map((function(e,t){var a=qe()(e[0].meta.time),n=qe()(e[1].meta.time);return{index:t+1,start:a.format("HH:mm:ss"),end:n.format("HH:mm:ss"),duration:Qe(a,n)}})),offtrackIntervalsSum:m}},et=function(e){var t=e.name;return o.a.createElement(he.a,null,o.a.createElement(he.d,{variant:"routeName"},t))},tt=function(e){var t=e.route,a=e.analysis,n=e.gpx;if(!a)return null;var r=$e(n,a);return o.a.createElement(he.a,{variant:"container"},o.a.createElement(he.c,{mb:De[12],sx:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement(et,{name:t.name})),n&&o.a.createElement(at,{data:r}),a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(he.d,{variant:"heading.h4"},"Precyzja lotu"),o.a.createElement(nt,{data:r})))},at=function(e){var t=e.data;return o.a.createElement(o.a.Fragment,null,o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"Pocz\u0105tek"),o.a.createElement(he.f,{fontWeight:"bold"},t.startTime)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"Koniec"),o.a.createElement(he.f,{fontWeight:"bold"},t.endTime)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"D\u0142ugo\u015b\u0107"),o.a.createElement(he.f,{fontWeight:"bold"},t.routeLength)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"Pokonany dystans"),o.a.createElement(he.f,{fontWeight:"bold"},t.distance)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"\u015arednia pr\u0119dko\u015b\u0107 w ruchu"),o.a.createElement(he.f,{fontWeight:"bold"},t.movingSpeed)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"\u015arednia pr\u0119dko\u015b\u0107 dla ca\u0142ego przebiegu"),o.a.createElement(he.f,{fontWeight:"bold"},t.totalSpeed)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"Minimalna wysoko\u015b\u0107 nad poziomem morza"),o.a.createElement(he.f,{fontWeight:"bold"},t.elevationMin)),o.a.createElement(he.a,{variant:"routeSummary"},o.a.createElement("span",null,"Maksymalna wysoko\u015b\u0107 nad poziomem morza"),o.a.createElement(he.f,{fontWeight:"bold"},t.elevationMax)))},nt=function(e){var t=e.data;return o.a.createElement(He,null,o.a.createElement(Ke,null,o.a.createElement(Ve,null,o.a.createElement(Je,null,"LP."),o.a.createElement(Je,null,"Opuszczenie trasy"),o.a.createElement(Je,null,"Powr\xf3t na tras\u0119"),o.a.createElement(Je,null,"Czas poza tras\u0105"))),o.a.createElement(Ye,null,t.offtrackIntervals.map((function(e){return o.a.createElement(Ve,{key:e.index},o.a.createElement(Xe,null,e.index),o.a.createElement(Xe,null,e.start),o.a.createElement(Xe,null,e.end),o.a.createElement(Xe,null,e.duration))})),!t.offtrackIntervals.length&&o.a.createElement(Ve,null,o.a.createElement(Xe,null,"-"),o.a.createElement(Xe,null,"-"),o.a.createElement(Xe,null,"-"),o.a.createElement(Xe,null,"-")),o.a.createElement(Ve,{sx:{fontWeight:"bold"}},o.a.createElement(Xe,{colSpan:3,sx:{textAlign:"left"}},"\u0141\u0105cznie"),o.a.createElement(Xe,null,t.offtrackIntervalsSum))))},rt=function(){var e=Object(R.c)(G),t=Object(R.c)(M),a=Object(r.useContext)(ce).layers,n=Object.keys(e).length;return o.a.createElement(o.a.Fragment,null,0===n&&o.a.createElement(he.f,null,"Nie za\u0142adowano \u017cadnych tras."),Object.entries(e).map((function(e){var n,r=Object(d.a)(e,2),l=(r[0],r[1]);return o.a.createElement(tt,{key:"route-".concat(l.id),route:l,analysis:t[l.id],gpx:null===(n=a[l.id])||void 0===n?void 0:n.gpx})})))},ot=a(93),lt=a.n(ot),ct=function(){var e=Object(je.a)(we.a.mark((function e(t,a,n){var r,o,l,c;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.info(n),t&&n){e.next=3;break}return e.abrupt("return");case 3:return r=new lt.a.Workbook,o=r.addWorksheet("My Sheet"),l=o.getRow(1),Object.values(t).forEach((function(e,t){var r=n[e.id],c=a[e.id].gpx,i=$e(c,r),u=5*t+1;l.getCell(u).value=e.name,o.getRow(2).getCell(u).value="Pocz\u0105tek",o.getRow(3).getCell(u).value=i.startTime,o.getRow(4).getCell(u).value="Koniec",o.getRow(5).getCell(u).value=i.endTime,o.getRow(6).getCell(u).value="D\u0142ugo\u015b\u0107",o.getRow(7).getCell(u).value=i.routeLength,o.getRow(8).getCell(u).value="Pokonany dystans",o.getRow(9).getCell(u).value=i.distance,o.getRow(10).getCell(u).value="\u015arednia pr\u0119dko\u015b\u0107 w ruchu",o.getRow(11).getCell(u).value=i.movingSpeed,o.getRow(12).getCell(u).value="\u015arednia pr\u0119dko\u015b\u0107 dla ca\u0142ego przebiegu",o.getRow(13).getCell(u).value=i.totalSpeed,o.getRow(14).getCell(u).value="Minimalna wysoko\u015b\u0107 nad poziomem morza",o.getRow(15).getCell(u).value=i.elevationMin,o.getRow(16).getCell(u).value="Maksymalna wysoko\u015b\u0107 nad poziomem morza",o.getRow(17).getCell(u).value=i.elevationMax,o.getRow(19).getCell(u).value="Precyzja lotu",o.getRow(20).getCell(u).value="LP.",o.getRow(20).getCell(u+1).value="Opuszczenie trasy",o.getRow(20).getCell(u+2).value="Powr\xf3t na tras\u0119",o.getRow(20).getCell(u+3).value="Czas poza tras\u0105",i.offtrackIntervals.length&&(i.offtrackIntervals.forEach((function(e,t){o.getRow(21+t).getCell(u).value=e.index,o.getRow(21+t).getCell(u+1).value=e.start,o.getRow(21+t).getCell(u+2).value=e.end,o.getRow(21+t).getCell(u+3).value=e.duration})),o.getRow(21+i.offtrackIntervals.length).getCell(u).value="\u0141\u0105cznie",o.getRow(21+i.offtrackIntervals.length).getCell(u+3).value=i.offtrackIntervalsSum)})),e.next=9,r.xlsx.writeBuffer();case 9:c=e.sent,it(c);case 11:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),it=function(e){var t=new Blob([e],{type:"application/xlsx"}),a=document.createElement("a");a.href=window.URL.createObjectURL(t);a.download="results.xlsx",a.click()},ut=function(){var e=Object(R.c)(M),t=Object(R.c)(G),a=Object(r.useContext)(ce).layers;return o.a.createElement(he.a,{sx:{position:"absolute",zIndex:500,height:"100%"},className:"sidebar"},o.a.createElement(he.c,{variant:"sidebar",flexDirection:"column",bg:"background",sx:{height:"100%"}},o.a.createElement(he.c,{variant:"header"},o.a.createElement(he.d,{variant:"heading.h2",mb:"0"},o.a.createElement(he.f,{as:"span",color:"primary"},"AERO"),o.a.createElement(he.f,{as:"span",color:"muted",fontWeight:"normal"},"CONTEST")),o.a.createElement(Ie,{href:"https://github.com/zefj/aerocontest",variant:"github",icon:"fab fa-github"})),o.a.createElement(he.a,{variant:"content"},o.a.createElement(ve.c,null,o.a.createElement(ve.a,{path:"/(welcome|)"},o.a.createElement(We,null)),o.a.createElement(ve.a,{path:"/route"},o.a.createElement(Ue,null)),o.a.createElement(ve.a,{path:"/summary"},o.a.createElement(rt,null)))),o.a.createElement(he.c,{as:"nav",variant:"nav"},o.a.createElement(ve.c,null,o.a.createElement(ve.a,{path:"/(welcome|)"},o.a.createElement(Be,{to:"/route",variant:"primary"},"Zaczynamy")),o.a.createElement(ve.a,{path:"/(route|)"},o.a.createElement(Be,{to:"/welcome",variant:"secondaryOutline"},"Wr\xf3\u0107"),o.a.createElement(Be,{to:"/summary",variant:"primary"},"Podsumowanie")),o.a.createElement(ve.a,{path:"/summary"},o.a.createElement(Be,{to:"/route",variant:"secondaryOutline"},"Wr\xf3\u0107"),o.a.createElement(Te,{onClick:function(){return ct(t,a,e)},sx:{marginLeft:De[8]},variant:"primaryOutline"},"Eksportuj dane"))))))},st=function(e){var t=e.icon,a=e.children;return o.a.createElement(he.c,{variant:"alert"},o.a.createElement(he.c,{variant:"alert.iconContainer"},o.a.createElement(he.a,{variant:"alert.icon",as:"i",className:t})),o.a.createElement(he.c,{sx:{flex:1}},o.a.createElement(he.a,{as:"span"},a)))},mt=function(){var e=Object(R.b)(),t=Object(R.c)(N),a=Object(R.c)(U);if(!t||!a)return null;var n,r=[(n=a).latLngs[0],n.latLngs[n.latLngs.length-1]],l=qe()(r[0].meta.time),c=qe()(r[1].meta.time),i="ontrack"===a.type||"unknown"===a.type,u="offtrack"===a.type||"unknown"===a.type;return o.a.createElement(he.a,{variant:"popup",sx:{position:"absolute",zIndex:500,width:"100%",maxWidth:"300px",left:"500px",top:"0"}},o.a.createElement(he.a,{variant:"content"},o.a.createElement(he.c,{sx:{justifyContent:"space-between",flexDirection:"column"}},o.a.createElement(he.c,{sx:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement(he.d,{variant:"heading.h4"},"Edycja fragmentu"),o.a.createElement(Te,{onClick:function(){return e({type:"SELECT_POLYLINE",payload:{id:void 0,ref:void 0}})},variant:"icon",icon:"fa-fw fas fa-times",sx:{marginBottom:De[12]}})),o.a.createElement(he.a,{variant:"container"},l.format("HH:mm:ss")," - ",c.format("HH:mm:ss")),"unknown"===a.type&&o.a.createElement(st,{icon:"fa-fw fas fa-exclamation"},"Fragment nieokre\u015blony, poniewa\u017c r\xf3\u017cnica pomi\u0119dzy s\u0105siaduj\u0105cymi odczytami pozycji wynosi wi\u0119cej ni\u017c 10 sekund. Domy\u015blnie, nieokre\u015blone fragmenty s\u0105 traktowane jako ",o.a.createElement("b",null,"poza tras\u0105"),"."),o.a.createElement(he.a,{variant:"label"},"Zalicz jako:"),o.a.createElement(he.c,null,u&&o.a.createElement(Te,{variant:"greenOutline",onClick:function(){return e(ee(t.id,t.analysis_id,"ontrack"))},sx:{width:"100%",marginRight:De[4]}},"W trasie"),i&&o.a.createElement(Te,{variant:"destructiveOutline",onClick:function(){return e(ee(t.id,t.analysis_id,"offtrack"))},sx:{width:"100%"}},"Poza tras\u0105")))))},dt=new u.a.FeatureGroup,ft=function(e){var t=e.children,a=Object(r.useState)({layers:{},trackLayer:dt,setGpx:function(){}}),n=Object(d.a)(a,2),l=n[0],c=l.layers,i=l.trackLayer,s=n[1],m=Object(r.useCallback)((function(e,t){var a=Object(_.a)({},c);c[e]&&(a[e].gpx=t,s({layers:a,trackLayer:i,setGpx:m}))}),[c,i]),f=Object(R.c)(G);return Object(r.useEffect)((function(){var e=!1,t=Object(_.a)({},c);Object.entries(f).forEach((function(a){var n=Object(d.a)(a,2),r=(n[0],n[1]);c[r.id]||(e=!0,t[r.id]=function(){var e=new u.a.FeatureGroup,t=new u.a.LayerGroup,a=new u.a.LayerGroup,n=new u.a.FeatureGroup,r=new u.a.LayerGroup,o=new u.a.FeatureGroup;return t.addTo(e),a.addTo(e),n.addTo(e),r.addTo(e),o.addTo(e),{markers:t,layers:e,offtrackFragmentsLayer:a,offtrackMarkersLayer:n,ontrackFragmentsLayer:r,ontrackMarkersLayer:o,gpx:null}}())})),e&&s({layers:t,trackLayer:i,setGpx:m})}),[c,f,m,i]),o.a.createElement(ce.Provider,{value:{layers:c,trackLayer:i,setGpx:m}},t)},pt=a(94),gt=a.n(pt),yt=a(95),Et=a.n(yt),bt=a(96),vt=a.n(bt);a(179);delete u.a.Icon.Default.prototype._getIconUrl,u.a.Icon.Default.mergeOptions({iconRetinaUrl:Et.a,iconUrl:gt.a,shadowUrl:vt.a});var ht=function(){var e=[ae.a],t=[te.applyMiddleware.apply(void 0,e)],a=ne.composeWithDevTools.apply(void 0,t);return Object(te.createStore)(le,{},a)}(),Ot=function(){return o.a.createElement(R.a,{store:ht},o.a.createElement(s.a,{theme:_e},o.a.createElement(he.a,{className:"App",sx:{fontFamily:"body",fontSize:"body",color:"text"}},o.a.createElement(m.a,null,o.a.createElement(ft,null,o.a.createElement(ut,null),o.a.createElement(mt,null),o.a.createElement(be,null))))))};c.a.render(o.a.createElement(Ot,null),document.getElementById("root"))},98:function(e,t,a){e.exports=a(180)}},[[98,1,2]]]);
//# sourceMappingURL=main.f7fd9501.chunk.js.map